- hosts: proxmox_servers
  roles:
    - proxmox-create-from-clone
  vars:
    template_id: 1000
    vm_name: VM-LB-01
    vm_id: 200
    tags: load-balancer,docker,glusterfs
    cores: 4
    memory: 2048
    ip_address: gw=192.168.0.1,ip=192.168.0.160/24
    disk_size: 50G
- hosts: proxmox_servers
  roles:
    - virtual-machine-create
- hosts: virtual_machines
  roles:
    - reboot
    - update
    - base-packages
    - snmp-configure
    - network-share-mount
- hosts: proxmox_servers
  roles:
    - pre-config-snapshot
- hosts: swarm_vms
  roles:
    - glusterfs-service
- hosts: loadbalancer
  roles:
    - glusterfs-configure
- hosts: swarm_vms
  roles:
    - glusterfs-mount
    - docker-install
- hosts: swarm_manager
  roles:
    - docker-swarm-init
- hosts: swarm_nodes
  roles: 
    - docker-swarm-join
- hosts: loadbalancer
  roles: 
    - loadbalancer-configure
- hosts: swarm_manager
  roles: 
    - portainer-agent-deploy
- hosts: git
  roles: 
    - gitlab-install
- hosts: virtual_machines
  roles: 
    - reboot
- hosts: proxmox_servers
  roles:
    - post-config-snapshot